<style>
  /* 顶级菜单项相对定位，用于放子菜单 */
  .navigation-item {
    position: relative;
  }

  /* 下拉菜单基础样式（悬浮菜单） */
  .navigation-submenu {
    position: absolute;
    top: 100%;
    left: 0;
    list-style: none;
    margin: 0;
    padding: 0.4rem 0;
    border-radius: 0.6rem;
    min-width: 150px;
    display: none;
    z-index: 20;
    color: inherit;
  }

  /* 亮色主题下的下拉菜单背景 & 阴影 */
  .colorscheme-light .navigation-submenu {
    background: rgba(255, 255, 255, 0.98);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.04);
  }

  /* 暗色主题下的下拉菜单背景 & 阴影 */
  .colorscheme-dark .navigation-submenu,
  .colorscheme-auto.dark .navigation-submenu {
    background: rgba(10, 10, 10, 0.98);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.06);
  }

  /* 子菜单链接基础样式 */
  .navigation-subitem .navigation-link {
    display: block;
    white-space: nowrap;
  }

  .navigation-subitem .navigation-link:hover {
    background: rgba(128, 128, 128, 0.15);
    text-decoration: none;
  }

  /* 有子菜单的顶级按钮：长得跟 a 一样 */
  .navigation-toggle {
    background: none;
    border: none;
    padding: 0;
    margin: 0;
    font: inherit;
    color: inherit;
    cursor: pointer;
  }

  /* 悬停 / focus 时显示下拉 */
  .navigation-item.has-children:hover > .navigation-submenu {
    display: block;
  }
  .navigation-item.has-children:focus-within > .navigation-submenu {
    display: block;
  }

  /* ========= 统一调小一点字号 + padding，兼顾大小屏 ========= */

  /* 顶部导航文字 */
  .navigation-link {
    padding: 0.2rem 0.5rem;     /* 比之前小一点 */
    font-size: 1.9rem;          /* 原来 1.9，整体缩一下 */
    line-height: 1.6;
    letter-spacing: 0.03em;
    font-weight: 700;
  }

  .navigation-toggle {
    padding: 0.2rem 0.5rem;
    line-height: 1.6;
  }

  /* 子菜单项 */
  .navigation-subitem .navigation-link {
    padding: 0.35rem 0.9rem;
    font-size: 1.5rem;
    line-height: 1.5;
    font-weight: 500;
  }

  /* 语言切换小 pill */
  .lang-switch a {
    font-size: 1.4rem;
    padding: 0.1rem 0.45rem;
    border-radius: 999px;
    border: 2px solid rgba(128, 128, 128, 0.5);
    font-weight: 600;
  }
</style>

</header>


<nav class="navigation">
  <section class="container">
    {{ with .Site }}
    <a class="navigation-title" href="{{ absLangURL "" }}">
      {{ .Title }}
    </a>
    {{ end }}
    {{ if or .Site.Menus.main hugo.IsMultilingual }}
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        {{ with .Site.Menus.main }}
          {{ range sort . }}
            {{/* 跳过子菜单，只在这里渲染顶级菜单项 */}}
            {{ if .Parent }}
              {{ continue }}
            {{ end }}

            {{ if .HasChildren }}
              <li class="navigation-item has-children">
                {{/* 顶级项改成 button，不再跳转，只负责展开子菜单 */}}
                <button class="navigation-link navigation-toggle {{ .Params.class }}" type="button">
                  {{ .Name }}
                </button>
                <ul class="navigation-submenu">
                  {{ range .Children }}
                    <li class="navigation-subitem">
                      <a class="navigation-link {{ .Params.class }}"
                         href="{{ index (apply (slice .URL) (.Params.urlFunc | default "relLangURL") ".") 0 }}">
                        {{ .Name }}
                      </a>
                    </li>
                  {{ end }}
                </ul>
              </li>
            {{ else }}
              <li class="navigation-item">
                <a class="navigation-link {{ .Params.class }}"
                   href="{{ index (apply (slice .URL) (.Params.urlFunc | default "relLangURL") ".") 0 }}">
                  {{ .Name }}
                </a>
              </li>
            {{ end }}
          {{ end }}
        {{ end }}

        {{ if hugo.IsMultilingual }}
          {{ $node := . }}
          {{ .Scratch.Set "separator" true }}
          {{ range (default .Site.Home.AllTranslations .Translations) }}
            {{ if ne $.Site.Language .Language }}
              {{ if $node.Scratch.Get "separator" }}
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                {{ $node.Scratch.Set "separator" false }}
              {{ end }}

              <!-- 这里加 lang-switch -->
              <li class="navigation-item lang-switch">
                <a class="navigation-link" href="{{ .RelPermalink }}">
                  {{ if eq .Language.Lang "en" }}
                    EN
                  {{ else if or (eq .Language.Lang "zh") (eq .Language.Lang "zh-cn") }}
                    CN
                  {{ else }}
                    {{ .Language.LanguageName }}
                  {{ end }}
                </a>
              </li>
            {{ end }}
          {{ end }}
        {{ end }}

      </ul>

    {{ end }}
  </section>
</nav>
